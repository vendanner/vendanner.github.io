---
layout:     post
title:      Azkaban 入门
subtitle:   
date:       2019-10-13
author:     danner
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Azkaban
    - 调度
    - bigdata
---

> https://azkaban.readthedocs.io/en/latest/getStarted.html#

### 安装

> https://azkaban.readthedocs.io/en/latest/getStarted.html#building-from-source

参考上面官方文档，下载编译安装即可。

在启动之前，先配个用户：

```xml
<!--  conf/azkaban-users.xml -->
<azkaban-users>
  <user groups="azkaban" password="azkaban" roles="admin" username="azkaban"/>
  <user password="metrics" roles="metrics" username="metrics"/>
  <!-- 新增 danner 用户，角色为 admin -->
  <user password="123456" roles="admin" username="danner"/>
  <role name="admin" permissions="ADMIN"/>
  <role name="metrics" permissions="METRICS"/>
</azkaban-users>
```

执行 `start-solo.sh ` 启动，会有 `AzkabanSingleServer` 进程，默认是在 `8081` 端口

![](https://vendanner.github.io/img/azkaban/login.png)

上图蓝色框图内的文字和端口都可以在 `conf/azkaban.properties` 文件中配置

### 案例

> https://azkaban.readthedocs.io/en/latest/useAzkaban.html

按上面文档创建一个项目

![](https://vendanner.github.io/img/azkaban/create_project.png)

![](https://vendanner.github.io/img/azkaban/test001.png)

> https://azkaban.readthedocs.io/en/latest/createFlows.html

按照上面的官方文档**配置**，上传 `Flow` 即可执行。下面通过几个小案例来熟悉

#### `Hello Azkaban`

创建一个文件夹，包含两个文件，层级如下

```shell
hello_azkaban
  -- flow20.project    // 文件名固定
  -- basic.flow			// 以 flow 后缀名，yaml 格式
```

 `flow20.project` : 只写 `azkaban-flow-version` 版本号

```shell
azkaban-flow-version: 2.0
```

`basic.flow`： 任务的内容和依赖

```yaml
nodes:
  - name: jobA
    type: command
    config:
      command: echo "hello azkaban ..."
```

将 `hello_azkaban` 文件夹打包成 `zip` 格式，点击 `Upload` 按钮上传

![](https://vendanner.github.io/img/azkaban/upload_flow.png)

点击 `Execute Flow` 去执行，执行过程和结果被展示

![](https://vendanner.github.io/img/azkaban/job_flow_stat.png)

点击 `Log` 查看

![](https://vendanner.github.io/img/azkaban/hello_azkaban_log.png)