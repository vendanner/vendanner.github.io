---
layout:     post
title:      CDH 错误集
subtitle:   
date:       2019-10-30
author:     danner
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - CDH
    - error
    - bigdata
---

### `kafka`

#### `console-consumer` 无法消费 msg

安装好 kafka 后，命令行测试创建主题，生产数据都没有问题，但consumer 始终无法接收到数据。`kafka log`(/var/local/kafka/data) 下主题文件存在且有数据，`--desctibe` 查看主题状态读正常。在log 目录 `/var/log/kafka` 下查看日志发现这么一行

```shell
2019-11-01 11:12:17,506 ERROR kafka.server.KafkaApis: 
[KafkaApi-43] Number of alive brokers '2' does not meet the required replication factor '3' 
for the offsets topic (configured via 'offsets.topic.replication.factor'). 
This error can be ignored if the cluster is starting up and not all brokers are up yet.
```

意思是 `offsets topic ` 副本数是3，而当前运行的 kafka broker 只有 2；broker 必须要大于等于 offset副本数，可以配置 `offsets.topic.replication.factor` 。知道解决方案了，直接去 CDH  web 界面的 kafka 配置里修改

![](https://vendanner.github.io/img/CDH/kafka_offset_factor.png)

保存配置然后重启 kafka 即可。

> 问题解决后，我们来说说为什么会有这个问题：刚开始安装 kafka 是有三台的，但有台机器内存吃不消就删除了，导致offset 副本默认是3。